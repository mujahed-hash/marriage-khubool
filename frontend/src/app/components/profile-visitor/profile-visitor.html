<div class="visitor-container">
    <h1 class="page-heading"><i class="fa-solid fa-eye"></i> Profile Visitors</h1>
    <p class="page-subtitle">People who viewed your profile</p>

    @if (loading()) {
    <div class="loading-state">
        <div class="spinner"></div>
        <p>Loading visitors...</p>
    </div>
    } @else if (visitors().length === 0) {
    <div class="empty-state">
        <i class="fa-solid fa-eye-slash"></i>
        <p>No one has viewed your profile yet.</p>
    </div>
    } @else {
    <div class="visitor-list">
        @for (v of visitors(); track v.viewedAt) {
        <div class="visitor-card">
            <img [src]="v.viewerProfile?.profilePhotoUrl || getPlaceholderImg(v.viewer?.gender)" alt="Visitor"
                class="visitor-avatar">
            <div class="visitor-info">
                <h3>{{ v.viewerProfile?.fullName || v.viewer?.fullName || 'Unknown' }}</h3>
                <p class="visitor-meta">{{ v.viewerProfile?.city || '' }}</p>
            </div>
            <div class="visitor-time">{{ timeAgo(v.viewedAt) }}</div>
            @if (v.viewerProfile?._id || v.viewerProfile?.profileId) {
            <a [routerLink]="['/profile', v.viewerProfile?._id || v.viewerProfile?.profileId]" class="btn-view">View</a>
            }
        </div>
        }
    </div>
    }
</div>