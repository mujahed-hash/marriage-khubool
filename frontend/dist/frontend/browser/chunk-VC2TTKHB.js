import{a as T}from"./chunk-GSGILDW7.js";import"./chunk-DQJ6WRPO.js";import{E as c,Ha as w,I as y,La as S,R as f,S as p,U as k,Ua as A,V as O,W as P,X as e,Y as a,Z as l,a as g,b as _,da as x,fa as b,ha as d,na as N,pa as s,qa as h,r as M,s as u,t as C,x as m}from"./chunk-AY3CH6AK.js";var D=(n,i)=>i._id;function I(n,i){n&1&&(e(0,"div",3),l(1,"div",5),e(2,"p"),s(3,"Loading..."),a()())}function R(n,i){n&1&&(e(0,"div",4),l(1,"i",6),e(2,"p"),s(3,"No notifications yet."),a()())}function z(n,i){if(n&1){let t=x();e(0,"button",11),b("click",function(){u(t);let r=d(2);return C(r.markAllAsRead())}),s(1,"Mark all as read"),a()}}function V(n,i){if(n&1){let t=x();e(0,"button",18),b("click",function(){u(t);let r=d().$implicit,E=d(2);return C(E.markAsRead(r._id))}),s(1,"Mark read"),a()}}function $(n,i){if(n&1&&(e(0,"div",12),l(1,"i",13),e(2,"div",14)(3,"p",15),s(4),a(),e(5,"span",16),s(6),a()(),f(7,V,2,0,"button",17),a()),n&2){let t=i.$implicit,o=d(2);N("unread",!t.read),c(),P("ngClass",o.getIcon(t.type)),c(3),h(t.message),c(2),h(o.timeAgo(t.createdAt)),c(),p(t.read?-1:7)}}function F(n,i){if(n&1&&(e(0,"div",7),f(1,z,2,0,"button",8),a(),e(2,"div",9),k(3,$,8,6,"div",10,D),a()),n&2){let t=d();c(),p(t.unreadCount()>0?1:-1),c(2),O(t.notifications())}}var v=class n{notifications=m([]);unreadCount=m(0);loading=m(!0);notificationService=M(T);ngOnInit(){this.load()}async load(){this.loading.set(!0);try{let i=await this.notificationService.getNotifications();this.notifications.set(i.notifications||[]),this.unreadCount.set(i.unreadCount||0)}catch{this.notifications.set([])}this.loading.set(!1)}async markAsRead(i){try{await this.notificationService.markAsRead(i),this.notifications.update(t=>t.map(o=>o._id===i?_(g({},o),{read:!0}):o)),this.unreadCount.update(t=>Math.max(0,t-1))}catch{}}async markAllAsRead(){try{await this.notificationService.markAllAsRead(),this.notifications.update(i=>i.map(t=>_(g({},t),{read:!0}))),this.unreadCount.set(0)}catch{}}getIcon(i){return{interest_received:"fa-heart",interest_accepted:"fa-heart-circle-check",profile_visited:"fa-eye",message_received:"fa-comments"}[i]||"fa-bell"}timeAgo(i){let t=new Date(i),r=Math.floor((new Date().getTime()-t.getTime())/1e3);return r<60?"Just now":r<3600?`${Math.floor(r/60)}m ago`:r<86400?`${Math.floor(r/3600)}h ago`:r<604800?`${Math.floor(r/86400)}d ago`:t.toLocaleDateString()}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=y({type:n,selectors:[["app-notifications"]],decls:7,vars:1,consts:[[1,"notifications-container"],[1,"page-heading"],[1,"fa-solid","fa-bell"],[1,"loading-state"],[1,"empty-state"],[1,"spinner"],[1,"fa-solid","fa-bell-slash"],[1,"notifications-actions"],[1,"btn-mark-all"],[1,"notifications-list"],[1,"notification-card",3,"unread"],[1,"btn-mark-all",3,"click"],[1,"notification-card"],[1,"fa-solid",3,"ngClass"],[1,"notification-body"],[1,"notification-message"],[1,"notification-time"],[1,"btn-mark-read"],[1,"btn-mark-read",3,"click"]],template:function(t,o){t&1&&(e(0,"div",0)(1,"h1",1),l(2,"i",2),s(3," Notifications"),a(),f(4,I,4,0,"div",3)(5,R,4,0,"div",4)(6,F,5,1),a()),t&2&&(c(4),p(o.loading()?4:o.notifications().length===0?5:6))},dependencies:[S,w,A],styles:[".notifications-container[_ngcontent-%COMP%]{width:100%;max-width:600px;margin:0 auto;padding:0 1rem}.page-heading[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;color:#1e293b;margin-bottom:1.5rem;display:flex;align-items:center;gap:.5rem}.page-heading[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:var(--tier-primary, #db2777)}.notifications-actions[_ngcontent-%COMP%]{margin-bottom:1rem}.btn-mark-all[_ngcontent-%COMP%]{padding:.4rem 1rem;background:var(--tier-primary, #db2777);color:#fff;border:none;border-radius:8px;font-weight:600;font-size:.85rem;cursor:pointer}.notifications-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem}.notification-card[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:1rem;padding:1rem;background:#fff;border-radius:12px;border:1px solid #e2e8f0}.notification-card.unread[_ngcontent-%COMP%]{background:#fef3f8;border-color:#fce7f3}.notification-card[_ngcontent-%COMP%] > i[_ngcontent-%COMP%]{font-size:1.25rem;color:var(--tier-primary, #db2777);margin-top:.2rem}.notification-body[_ngcontent-%COMP%]{flex:1}.notification-message[_ngcontent-%COMP%]{margin:0;font-size:.95rem;color:#334155}.notification-time[_ngcontent-%COMP%]{font-size:.8rem;color:#94a3b8;margin-top:.25rem;display:block}.btn-mark-read[_ngcontent-%COMP%]{padding:.3rem .75rem;background:transparent;border:1px solid var(--tier-primary);color:var(--tier-primary);border-radius:6px;font-size:.8rem;cursor:pointer}.loading-state[_ngcontent-%COMP%], .empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:200px;color:#64748b}.empty-state[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:2.5rem;color:#cbd5e1;margin-bottom:.5rem}.spinner[_ngcontent-%COMP%]{width:32px;height:32px;border:3px solid #f3f4f6;border-top-color:var(--tier-primary);border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin-bottom:.5rem}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}"]})};export{v as NotificationsComponent};
