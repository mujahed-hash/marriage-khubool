import{e as E}from"./chunk-H5DOWRHO.js";import{$b as D,Ca as P,Eb as O,La as C,Ma as x,Mb as T,Nb as V,Oa as w,Ob as k,Pa as v,R as m,Ra as n,Rb as W,S as g,Sa as t,Ta as y,Tb as A,Xa as M,Xb as z,Yb as F,Za as p,_a as c,_b as L,aa as f,cb as o,db as b,gb as u,hb as _,ib as h,pa as d,xa as S}from"./chunk-RU7WV6XK.js";var N=(s,r)=>r.tier;function B(s,r){s&1&&(n(0,"div",2),o(1,"Loading settings..."),t())}function U(s,r){if(s&1){let e=M();n(0,"tr")(1,"td")(2,"span",17),o(3),t()(),n(4,"td")(5,"input",18),h("ngModelChange",function(i){let l=m(e).$implicit;return _(l.amount,i)||(l.amount=i),g(i)}),p("ngModelChange",function(){m(e);let i=c(2);return g(i.saveSettings())}),t()(),n(6,"td")(7,"input",19),h("ngModelChange",function(i){let l=m(e).$implicit;return _(l.duration,i)||(l.duration=i),g(i)}),p("ngModelChange",function(){m(e);let i=c(2);return g(i.saveSettings())}),t()()()}if(s&2){let e=r.$implicit;d(3),b(e.tier),d(2),u("ngModel",e.amount),d(2),u("ngModel",e.duration)}}function G(s,r){if(s&1){let e=M();n(0,"div",4)(1,"h3",5),o(2,"General"),t(),n(3,"div",6)(4,"label",7),o(5,"Maintenance mode"),t(),n(6,"label",8)(7,"input",9),h("ngModelChange",function(i){m(e);let l=c();return _(l.maintenanceMode,i)||(l.maintenanceMode=i),g(i)}),p("ngModelChange",function(){m(e);let i=c();return g(i.saveSettings())}),t(),y(8,"span",10),t()(),n(9,"p",11),o(10,"When enabled, users see a maintenance banner on the main app."),t()(),n(11,"div",4)(12,"h3",5),o(13,"Limits"),t(),n(14,"div",6)(15,"label",12),o(16,"Max photos per user"),t(),n(17,"input",13),h("ngModelChange",function(i){m(e);let l=c();return _(l.maxPhotos,i)||(l.maxPhotos=i),g(i)}),p("ngModelChange",function(){m(e);let i=c();return g(i.saveSettings())}),t()(),n(18,"p",11),o(19,"Maximum number of photos a user can upload."),t()(),n(20,"div",4)(21,"h3",5),o(22,"Tier pricing"),t(),n(23,"table",14)(24,"thead")(25,"tr")(26,"th"),o(27,"Tier"),t(),n(28,"th"),o(29,"Amount (\u20B9)"),t(),n(30,"th"),o(31,"Duration"),t()()(),n(32,"tbody"),w(33,U,8,3,"tr",null,N),t()(),n(35,"p",11),o(36,"Use Orders page to manually grant tiers."),t()(),n(37,"div",4)(38,"h3",5),o(39,"Feature profiles"),t(),n(40,"p",15),o(41,"Manage which profiles appear in the homepage diamond section."),t(),n(42,"a",16),o(43,"Go to Profiles \u2192"),t(),n(44,"p",11),o(45,'Use the "Feature" action on individual profiles to feature them.'),t()()}if(s&2){let e=c();d(7),u("ngModel",e.maintenanceMode),d(10),u("ngModel",e.maxPhotos),d(16),v(e.tiers)}}function j(s,r){if(s&1&&(n(0,"div",3),o(1),t()),s&2){let e=c();d(),b(e.toast())}}var I=class s{constructor(r){this.api=r}maintenanceMode=!1;maxPhotos=10;tiers=[{tier:"silver",amount:0,duration:"1 month"},{tier:"gold",amount:0,duration:"1 month"},{tier:"diamond",amount:0,duration:"1 month"},{tier:"crown",amount:0,duration:"1 month"}];loading=f(!0);toast=f("");saveTimeout;ngOnInit(){this.load()}async load(){this.loading.set(!0);try{let r=await this.api.getPlatformSettings();if(this.maintenanceMode=r.maintenanceMode??!1,this.maxPhotos=r.maxPhotosPerUser??10,Array.isArray(r.tierPricing)&&r.tierPricing.length&&(this.tiers=r.tierPricing.map(e=>({tier:e.tier,amount:e.amount??0,duration:e.duration??"1 month"}))),this.tiers.length<4){let e=this.tiers.map(a=>a.tier);["silver","gold","diamond","crown"].forEach(a=>{e.includes(a)||this.tiers.push({tier:a,amount:0,duration:"1 month"})})}}catch{}this.loading.set(!1)}saveSettings(){clearTimeout(this.saveTimeout),this.saveTimeout=setTimeout(()=>this.doSave(),500)}async doSave(){try{await this.api.putPlatformSettings({maintenanceMode:this.maintenanceMode,maxPhotosPerUser:this.maxPhotos,tierPricing:this.tiers}),this.showToast("Settings saved.")}catch{this.showToast("Failed to save settings.")}}showToast(r){this.toast.set(r),setTimeout(()=>this.toast.set(""),3e3)}static \u0275fac=function(e){return new(e||s)(S(D))};static \u0275cmp=P({type:s,selectors:[["app-settings"]],decls:6,vars:2,consts:[[1,"settings-page"],[1,"page-title"],[1,"loading"],[1,"toast"],[1,"settings-card"],[1,"card-title"],[1,"setting-row"],[1,"toggle-label"],[1,"toggle"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"slider"],[1,"setting-hint"],[1,"input-label"],["type","number","min","1","max","50",1,"input-field",3,"ngModelChange","ngModel"],[1,"tier-table"],[1,"setting-desc"],["routerLink","/profiles",1,"btn-link"],[1,"tier-badge"],["type","number",1,"input-field","small",3,"ngModelChange","ngModel"],["type","text",1,"input-field",3,"ngModelChange","ngModel"]],template:function(e,a){e&1&&(n(0,"div",0)(1,"h2",1),o(2,"Platform Settings"),t(),C(3,B,2,0,"div",2)(4,G,46,2),C(5,j,2,1,"div",3),t()),e&2&&(d(3),x(a.loading()?3:4),d(2),x(a.toast()?5:-1))},dependencies:[O,L,V,A,T,k,F,z,W,E],styles:['.settings-page[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}.page-title[_ngcontent-%COMP%]{color:#f1f5f9;font-size:1.5rem;font-weight:700;margin:0}.loading[_ngcontent-%COMP%]{color:#94a3b8;padding:2rem}.settings-card[_ngcontent-%COMP%]{background:#1e293b;border-radius:12px;padding:1.5rem;border:1px solid #334155}.card-title[_ngcontent-%COMP%]{color:#f1f5f9;font-size:1rem;font-weight:600;margin:0 0 1rem}.setting-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;margin-bottom:.5rem}.toggle-label[_ngcontent-%COMP%], .input-label[_ngcontent-%COMP%]{color:#94a3b8;font-size:.9rem;min-width:160px}.toggle[_ngcontent-%COMP%]{position:relative;display:inline-block;width:48px;height:26px}.toggle[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{opacity:0;width:0;height:0}.slider[_ngcontent-%COMP%]{position:absolute;cursor:pointer;inset:0;background:#334155;border-radius:26px;transition:.3s}.slider[_ngcontent-%COMP%]:before{position:absolute;content:"";height:20px;width:20px;left:3px;bottom:3px;background:#f1f5f9;border-radius:50%;transition:.3s}.toggle[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]{background:#10b981}.toggle[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]:before{transform:translate(22px)}.input-field[_ngcontent-%COMP%]{padding:.5rem .75rem;border-radius:8px;border:1px solid #334155;background:#0f172a;color:#f1f5f9;font-size:.9rem;width:120px}.input-field.small[_ngcontent-%COMP%]{width:80px}.setting-hint[_ngcontent-%COMP%], .setting-desc[_ngcontent-%COMP%]{color:#64748b;font-size:.8rem;margin:.5rem 0 0}.tier-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-top:.5rem}.tier-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{color:#64748b;font-size:.75rem;text-transform:uppercase;letter-spacing:.5px;padding:.6rem 0;text-align:left}.tier-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.6rem 0;border-top:1px solid #334155;color:#f1f5f9;font-size:.9rem}.tier-badge[_ngcontent-%COMP%]{padding:.25rem .6rem;border-radius:12px;font-size:.75rem;font-weight:700;text-transform:uppercase;background:#334155}.btn-link[_ngcontent-%COMP%]{display:inline-block;margin-top:.75rem;color:#10b981;font-size:.9rem;font-weight:600;text-decoration:none}.btn-link[_ngcontent-%COMP%]:hover{text-decoration:underline}.toast[_ngcontent-%COMP%]{position:fixed;bottom:2rem;right:2rem;background:#1e293b;border:1px solid #10b981;color:#10b981;padding:.75rem 1.25rem;border-radius:10px;font-size:.9rem;font-weight:600;z-index:200}']})};export{I as SettingsComponent};
