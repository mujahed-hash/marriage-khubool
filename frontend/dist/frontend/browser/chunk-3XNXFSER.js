import{a as R}from"./chunk-T4FX5X2H.js";import{a as B}from"./chunk-NDOALP63.js";import{a as A}from"./chunk-ZL6BGGL6.js";import{a as D}from"./chunk-6DK54TEO.js";import{a as z}from"./chunk-BRHAC2FS.js";import"./chunk-DQJ6WRPO.js";import{Aa as y,Ba as I,C as M,E as o,Ha as w,I as v,La as E,Pa as T,R as p,S as f,Sa as N,T as b,U as C,Ua as k,V as x,W as m,X as r,Y as a,Z as u,a as _,fa as S,ha as s,oa as L,pa as l,qa as P,r as g,ra as c,x as h,za as O}from"./chunk-AY3CH6AK.js";var j=t=>["/profile",t],F=(t,i)=>i._id||i.profileId||t;function $(t,i){if(t&1&&(r(0,"p",2),l(1),a()),t&2){let e=s();o(),c("",e.total()," members in this tier. Login to view profiles.")}}function H(t,i){if(t&1&&(r(0,"a",6)(1,"div",7),u(2,"i",8),a(),r(3,"div",9)(4,"h3"),l(5,"Member"),a(),r(6,"p"),l(7,"Login to view profile"),a()()()),t&2){let e=i.$implicit,n=s(2);m("routerLink",n.getLoginRedirect(e))}}function Y(t,i){if(t&1&&C(0,H,8,1,"a",6,b),t&2){let e=s();x(e.profileIds())}}function q(t,i){if(t&1&&(r(0,"span",12),l(1),a()),t&2){let e=s().$implicit,n=s(2);o(),c("",n.getMatchScore(e._id),"% Match")}}function J(t,i){if(t&1&&(r(0,"a",10),u(1,"img",11),y(2,"photoUrl"),r(3,"div",9),p(4,q,2,1,"span",12),r(5,"h3"),l(6),a(),r(7,"p"),l(8),a(),r(9,"p"),l(10),a(),r(11,"p"),l(12),a(),r(13,"p"),l(14),a()()()),t&2){let e=i.$implicit,n=s(2);m("routerLink",O(10,j,e.profileId||e._id)),o(),m("src",I(2,8,e.profilePhotoUrl)||n.getPlaceholderImg(e.gender),M),o(3),f(e._id&&n.getMatchScore(e._id)!=null?4:-1),o(2),P(e.fullName||"Profile"),o(2),c("DOB: ",e.dateOfBirth||"N/A"),o(2),P(e.occupation||"N/A"),o(2),c("Height: ",e.height||"N/A"),o(2),c("Location: ",e.city||e.state||"N/A")}}function K(t,i){if(t&1&&C(0,J,15,12,"a",10,F),t&2){let e=s();x(e.profiles())}}function Q(t,i){if(t&1&&(r(0,"p",4),l(1),a()),t&2){let e=s();o(),c("No ",e.tier," profiles yet.")}}function V(t,i){if(t&1&&(r(0,"p",4),l(1),a()),t&2){let e=s();o(),c("No ",e.tier," profiles yet.")}}function W(t,i){t&1&&(r(0,"div",5),u(1,"i",13),r(2,"span"),l(3,"Loading more profiles..."),a()())}var G=class t{tier="";profiles=h([]);profileIds=h([]);total=h(0);limit=12;currentPage=1;isLoading=!1;hasMore=!0;matchScores=h({});route=g(T);profileService=g(D);matchService=g(R);authService=g(z);get isGuest(){return!this.authService.isAuthenticated()}ngOnInit(){this.route.params.subscribe(i=>{this.tier=i.tier||"gold",this.resetAndLoad()})}resetAndLoad(){this.currentPage=1,this.hasMore=!0,this.profiles.set([]),this.profileIds.set([]),this.load()}load(){this.tier&&(this.isLoading||!this.hasMore||(this.isLoading=!0,this.profileService.getProfiles({tier:this.tier,page:this.currentPage,limit:this.limit}).then(i=>{let e=i;if(this.isGuest&&e.profileIds)this.profileIds.update(d=>[...d,...e.profileIds||[]]);else{let d=i.profiles||[];this.profiles.update(U=>[...U,...d]),this.loadMatchScores(d)}this.total.set(i.total??0);let n=(e.profileIds||i.profiles||[]).length;this.hasMore=n===this.limit,this.isLoading=!1},()=>{this.isLoading=!1,this.hasMore=!1})))}onScrollLoadMore(){!this.isLoading&&this.hasMore&&(this.currentPage++,this.load())}async loadMatchScores(i){if(!(!this.authService.isAuthenticated()||!i.length))try{let e=i.map(d=>d._id).filter(Boolean);if(e.length===0)return;let n=await this.matchService.getMatchScoresBatch(e);this.matchScores.update(d=>_(_({},d),n.scores))}catch{}}getMatchScore(i){return this.matchScores()[i]??null}get tierTitle(){return this.tier.charAt(0).toUpperCase()+this.tier.slice(1)+" Profiles"}get tierIcon(){return{gold:"fa-solid fa-trophy",diamond:"fa-solid fa-gem",silver:"fa-solid fa-medal",bronze:"fa-solid fa-award",crown:"fa-solid fa-gem"}[this.tier]||"fa-solid fa-user"}getPlaceholderImg(i){return i==="female"?"assets/bride.png":"assets/groom.png"}getLoginRedirect(i){return`/login?redirect=${encodeURIComponent("/profile/"+i)}`}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=v({type:t,selectors:[["app-profile-list"]],decls:11,vars:11,consts:[["appInfiniteScroll","",1,"profile-list-container",3,"scrolled","isLoading","hasMore"],[1,"profile-list-heading",3,"ngClass"],[1,"profile-list-guest-hint"],[1,"profile-list-content"],[1,"profile-list-empty"],[1,"profile-list-loading"],[1,"profile-list-card","profile-list-card-guest",3,"routerLink"],[1,"profile-list-img","profile-list-placeholder"],[1,"fa-solid","fa-user"],[1,"profile-list-info"],[1,"profile-list-card",3,"routerLink"],["loading","lazy","alt","",1,"profile-list-img",3,"src"],[1,"match-badge"],[1,"fa-solid","fa-spinner","fa-spin"]],template:function(e,n){e&1&&(r(0,"div",0),S("scrolled",function(){return n.onScrollLoadMore()}),r(1,"h1",1),u(2,"i"),l(3),a(),p(4,$,2,1,"p",2),r(5,"div",3),p(6,Y,2,0)(7,K,2,0),p(8,Q,2,1,"p",4),p(9,V,2,1,"p",4),a(),p(10,W,4,0,"div",5),a()),e&2&&(m("isLoading",n.isLoading)("hasMore",n.hasMore),o(),m("ngClass","tier-"+n.tier),o(),L(n.tierIcon),o(),c(" ",n.tierTitle," "),o(),f(n.isGuest&&n.total()>0?4:-1),o(2),f(n.isGuest?6:7),o(2),f(!n.isGuest&&n.profiles().length===0&&!n.isLoading?8:-1),o(),f(n.isGuest&&n.profileIds().length===0&&n.total()===0&&!n.isLoading?9:-1),o(),f(n.isLoading?10:-1))},dependencies:[E,w,k,N,B,A],styles:[".profile-list-container[_ngcontent-%COMP%]{padding:0 0 1.5rem;width:100%}.profile-list-heading[_ngcontent-%COMP%]{margin:0 0 1rem}.profile-list-heading[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:.5rem}.profile-list-heading.tier-gold[_ngcontent-%COMP%]{color:#d4af37}.profile-list-heading.tier-diamond[_ngcontent-%COMP%]{color:#b9f2ff}.profile-list-heading.tier-silver[_ngcontent-%COMP%]{color:silver}.profile-list-heading.tier-bronze[_ngcontent-%COMP%]{color:#cd7f32}.profile-list-heading.tier-crown[_ngcontent-%COMP%]{color:#d11616}.profile-list-content[_ngcontent-%COMP%]{background:#fff;border-radius:15px;padding:2rem;box-shadow:0 4px 20px #0000001a;display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:1.5rem}.profile-list-card[_ngcontent-%COMP%]{display:flex;gap:1rem;padding:1rem;border:1px solid #eee;border-radius:12px;text-decoration:none;color:inherit;transition:box-shadow .2s,transform .2s}.profile-list-card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #0000001a;transform:translateY(-2px)}.profile-list-info[_ngcontent-%COMP%]   .match-badge[_ngcontent-%COMP%]{display:inline-block;background:var(--tier-primary, #db2777);color:#fff;font-size:.7rem;font-weight:600;padding:.2rem .5rem;border-radius:6px;margin-bottom:.25rem}.profile-list-img[_ngcontent-%COMP%]{width:80px;height:80px;object-fit:cover;border-radius:8px}.profile-list-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 .5rem;font-size:1.1rem}.profile-list-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.25rem 0;font-size:.9rem;color:#555}.pagination[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:1rem;margin-top:2rem;flex-wrap:wrap}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.5rem 1rem;border:1px solid #ddd;background:#fff;border-radius:8px;cursor:pointer;font-size:.9rem}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--tier-secondary, #fff7e6);border-color:var(--tier-primary, #8a5a44)}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.pagination[_ngcontent-%COMP%]   .page-info[_ngcontent-%COMP%]{font-size:.9rem;color:#666}.profile-list-guest-hint[_ngcontent-%COMP%]{margin:0 0 1rem;font-size:.95rem;color:#666}.profile-list-card-guest[_ngcontent-%COMP%]   .profile-list-placeholder[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:8px;background:#e5e7eb;display:flex;align-items:center;justify-content:center;font-size:2rem;color:#9ca3af}.profile-list-empty[_ngcontent-%COMP%]{grid-column:1 / -1;text-align:center;padding:2rem;color:#666}.profile-list-loading[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:.5rem;padding:1.5rem;color:#666}.profile-list-loading[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.25rem}"]})};export{G as ProfileListComponent};
