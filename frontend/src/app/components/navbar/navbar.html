<header>
    <nav class="nav">
        <div class="nav-left">
            <button class="menu-toggle" (click)="toggleMenu()" aria-label="Toggle menu">
                <i class="fa-solid fa-bars"></i>
            </button>
            <div class="logo">
                <a routerLink="/">
                    <img src="assets/logo.png" alt="Khubool Hai">
                </a>
            </div>
        </div>
        <form class="search-bar hidden-mobile" (ngSubmit)="onSearch()">
            <input type="text" [(ngModel)]="searchQuery" name="searchQuery"
                placeholder="Search by name, city, occupation...">
            <button type="submit" class="search-btn"><i class="fa-solid fa-magnifying-glass"></i></button>
        </form>
        <div class="icon-bar">
            <i class="fa-solid fa-heart hidden-mobile"></i>
            <i class="fa-solid fa-comments hidden-mobile"></i>
            @if (authService.isAuthenticated()) {
            <div class="dropdown notification-dropdown">
                <a routerLink="/notifications" (click)="dropdownOpen = false" class="notification-bell"
                    title="Notifications">
                    <i class="fa-solid fa-bell"></i>
                    @if (notificationCount() > 0) {
                    <span class="notification-badge">{{ notificationCount() > 99 ? '99+' : notificationCount() }}</span>
                    }
                </a>
            </div>
            }
            <div class="dropdown">
                <span (click)="toggleDropdown()">
                    <a href="javascript:void(0)" id="userButton"><i class="fa-solid fa-circle-user"></i></a>
                </span>
                <div class="dropdown-content" [class.show]="dropdownOpen">
                    <a routerLink="/" class="nav-link" (click)="dropdownOpen = false"><i class="fa-solid fa-house"></i>
                        Homepage</a>

                    <ng-container *ngIf="authService.isAuthenticated(); else authLinks">
                        <a routerLink="/my-profile" (click)="dropdownOpen = false"><i
                                class="fa-solid fa-address-card"></i> My Profile</a>
                        <a routerLink="/profile-visitors" (click)="dropdownOpen = false"><i class="fa-solid fa-eye"></i>
                            Profile
                            visitors ({{ visitorCount }})</a>
                        <a routerLink="/membership" (click)="dropdownOpen = false"><i
                                class="fa-brands fa-web-awesome"></i> Membership</a>
                        <a routerLink="/settings" (click)="dropdownOpen = false"><i class="fa-solid fa-gear"></i>
                            Settings</a>
                        <a href="javascript:void(0)" (click)="logout()"><i class="fa-solid fa-power-off"></i> Logout</a>
                    </ng-container>

                    <ng-template #authLinks>
                        <a routerLink="/login" (click)="dropdownOpen = false"><i
                                class="fa-solid fa-right-to-bracket"></i> Login</a>
                        <a routerLink="/register" (click)="dropdownOpen = false"><i class="fa-solid fa-user-plus"></i>
                            Register</a>
                    </ng-template>
                </div>
            </div>
        </div>
    </nav>

    <!-- Mobile Menu Drawer -->
    <div class="mobile-menu-overlay" *ngIf="menuOpen()" (click)="toggleMenu()">
        <div class="mobile-menu" (click)="$event.stopPropagation()">
            <div class="mobile-menu-header">
                <img src="assets/logo.png" alt="Logo">
                <button class="close-btn" (click)="toggleMenu()">âœ•</button>
            </div>
            <div class="mobile-menu-links">
                <a routerLink="/" (click)="toggleMenu()"><i class="fa-solid fa-house"></i> Home</a>
                <ng-container *ngIf="authService.isAuthenticated(); else mobileAuth">
                    <a routerLink="/my-profile" (click)="toggleMenu()"><i class="fa-solid fa-user"></i> My Profile</a>
                    <a routerLink="/search" (click)="toggleMenu()"><i class="fa-solid fa-magnifying-glass"></i>
                        Search</a>
                    <a routerLink="/shortlist" (click)="toggleMenu()"><i class="fa-solid fa-heart"></i> Shortlist</a>
                    <a routerLink="/interests" (click)="toggleMenu()"><i class="fa-solid fa-star"></i> Interests</a>
                    <a routerLink="/chat" (click)="toggleMenu()"><i class="fa-solid fa-comments"></i> Chat</a>
                    <a routerLink="/membership" (click)="toggleMenu()"><i class="fa-solid fa-crown"></i> Membership</a>
                    <a routerLink="/settings" (click)="toggleMenu()"><i class="fa-solid fa-gear"></i> Settings</a>
                    <a href="javascript:void(0)" (click)="logout(); toggleMenu()"><i class="fa-solid fa-power-off"></i>
                        Logout</a>
                </ng-container>
                <ng-template #mobileAuth>
                    <a routerLink="/login" (click)="toggleMenu()"><i class="fa-solid fa-right-to-bracket"></i> Login</a>
                    <a routerLink="/register" (click)="toggleMenu()"><i class="fa-solid fa-user-plus"></i> Register</a>
                </ng-template>
            </div>
        </div>
    </div>
</header>